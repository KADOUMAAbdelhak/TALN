% !TEX TS-program = pdflatex
% !TeX program = pdflatex
% !TEX encoding = UTF-8
% !TEX spellcheck = fr

\documentclass[xcolor=table]{beamer}

\input{options}

\title[TALN : 05- Analyse syntaxique]%
{Traitement automatique du langage naturel\\Chapitre 05 : Analyse syntaxique} 

\changegraphpath{../img/syntaxe/}

\begin{document}
	
\begin{frame}
\frametitle{Traitement automatique du langage naturel}
\framesubtitle{Analyse syntaxique : Introduction}

\begin{exampleblock}{Exemple d'une phrase en français}
	\begin{center}
		\Large\bfseries
		L'élève a écrit une solution avec un stylo. 
		
		L'élève a écrit une solution avec une explication.
	\end{center}
\end{exampleblock}

\begin{itemize}
	\item Qui a écrit la solution ?
	\item Quel instrument a-t-il utilisé pour l'écriture ?
	\begin{itemize}
		\item Un stylo ? Une explication ?
	\end{itemize}
	\item Est-ce qu'il y avait d'autre chose en plus de la solution ?
	\begin{itemize}
		\item Un stylo ? Une explication ?
	\end{itemize}
	\item Comment avez-vous déduit ça ?
\end{itemize}

\end{frame}

%\begin{frame}
%\frametitle{Traitement automatique du langage naturel}
%\framesubtitle{Analyse syntaxique : Un peu d'humour}
%
%\begin{center}
%	\vgraphpage{humour-pos.jpg}
%\end{center}
%
%\end{frame}

\begin{frame}
\frametitle{Traitement automatique du langage naturel}
\framesubtitle{Analyse syntaxique : Plan}

\begin{multicols}{2}
%	\small
\tableofcontents
\end{multicols}
\end{frame}

%===================================================================================
\section{Structures syntaxiques}
%===================================================================================

\begin{frame}
\frametitle{Analyse syntaxique}
\framesubtitle{Structures syntaxiques}

\begin{itemize}
	\item Une phrase peut être bien formée syntaxiquement mais pas sémantiquement 
	\begin{itemize}
		\item Ex. \expword{Les idées vertes et non colorées dorment furieusement.}
	\end{itemize}
	\item Plusieurs théories 
	\begin{itemize}
		\item La grammaire générative et transformationnelle : Ex. \expword{Grammaire générative et transformationnelle (TTG)}
		\item La grammaire de dépendance 
		\item La grammaire catégorique
		\item Les grammaires stochastiques
		\item Les approches fonctionnelles de la grammaire
	\end{itemize}
	
\end{itemize}

\end{frame}

%\subsection{Grammaires à contexte libre}

\subsection{Annotation constituante}

\begin{frame}
\frametitle{Analyse syntaxique : Structures syntaxiques}
\framesubtitle{Annotation constituante}

\begin{itemize}
	\item Les mots d'une phrase ont chacun \keyword{une catégorie grammaticale}
	\begin{itemize}
		\item Ex. \expword{Le/DET cours/NOM est/VP intéressant/ADJ}
	\end{itemize}
	\item Un ou plusieurs mots de certaines catégories forment \keyword{un syntagme}
	\begin{itemize}
		\item Ex. \expword{[Le/DET cours/NOM ]\textsubscript{NP} [est/VP intéressant/ADJ VP]\textsubscript{VP}}
	\end{itemize}
\end{itemize}

\begin{center}
	\includegraphics[width=0.4\textwidth]{../img/intro/gram_const.pdf}
\end{center}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Structures syntaxiques}
\framesubtitle{Annotation constituante : Grammaires à contexte libre (CFG)}

\begin{itemize}
	\item $G <\Sigma, N, P, S>$ est une grammaire.
	\item $\Sigma$ est le vocabulaire : ensemble des symboles terminaux
	\begin{itemize}
		\item \expword{$\Sigma$ = \{le, petit, chat, mange, un, poisson, ...\}}
	\end{itemize}
	\item $V$ est l'ensemble des  variables : symboles non terminaux 
	\begin{itemize}
		\item \expword{$N$ = \{S, NP, VP, DET, N, ADJ, ...\}}
	\end{itemize}
	\item $S \in N$ est l'axiome.
	\item $P$ est l'ensemble des règles de production.
	\item Les règles sont de la forme $A \rightarrow \beta \text{ avec } A \in N,\, \beta \in (\Sigma \cup N)^*$
	\begin{itemize}
		\item \expword{S \textrightarrow NP VP}
		\item \expword{NP \textrightarrow DET ADJ N \textbar\ DET N}
		\item \expword{VP \textrightarrow V NP}
	\end{itemize}
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Structures syntaxiques}
\framesubtitle{Annotation constituante : CFG probabiliste (PCFG)}

\begin{itemize}
	\item $G <\Sigma, N, P, S>$ est une grammaire.
	\item Les règles sont de la forme $A \rightarrow \beta\, [p] \text{ avec } A \in N,\, \beta \in (\Sigma \cup N)^*$
	\item $p$ est la probabilité d'occurrence de la règle
	\item Cette probabilité est estimée à partir d'un corpus annoté (\keyword{TreeBank})
\end{itemize}

\begin{block}{Estimation des probabilité des règles}
	\[
	P(A \rightarrow \beta | A) = \frac{C(A \rightarrow \beta)}{C(A)}
	\]
\end{block}

\end{frame}

\subsection{Annotation fonctionnelle}

\begin{frame}
\frametitle{Analyse syntaxique : Structures syntaxiques}
\framesubtitle{Annotation fonctionnelle}

\begin{itemize}
	\item Un mot ou plus remplissent \keyword{une fonction syntaxique}
	\begin{itemize}
		\item Ex. \expword{sujet, objet, etc.}
	\end{itemize}
	\item Les liens syntaxiques entre les mots d'une phrase sont appelés : \keyword{dépendances}
	\begin{itemize}
		\item Ex. \expword{Le chat mange un poisson} : ici ``chat" est \expword{le sujet} du verbe ``mange"
	\end{itemize}
	\item Une relation de dépendance relie entre un mot appelé \keyword{tête syntaxique} et d'autres appelés \keyword{dépendants}
\end{itemize}

\includegraphics[width=\textwidth]{../img/intro/gram-dep_.pdf}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Structures syntaxiques}
\framesubtitle{Annotation fonctionnelle : Relations de dépendance}

\begin{table}
	\rowcolors{2}{lightblue}{lightyellow}
	\begin{tabular}{p{.2\textwidth}p{.35\textwidth}p{.35\textwidth}}
		\rowcolor{darkblue}
		\textcolor{white}{Dép. de base} & \textcolor{white}{Description} & \textcolor{white}{Exemple}\\
		nsubj & sujet nominal & Le \underline{people} \textbf{gagne}\\
		obj & objet direct & On \textbf{présente} le \underline{cours}\\
		iobj & objet indirect & Il \underline{m'}\textbf{envoie}\\
		csubj & sujet propositionnel & \underline{Suivre} le cours \textbf{permet} ...\\
		
		\rowcolor{darkblue}
		\textcolor{white}{Dép. des noms} & \textcolor{white}{Description} & \textcolor{white}{Exemple}\\
		amod & modificateur adjectival & La \textbf{fille} \underline{modeste}\\
		det & déterminant & \underline{La} \textbf{fille}\\
		nmod & modificateur nominal & Le \underline{résultat} de la \textbf{course}\\
		nummod & modificateur numérique & J'ai mangé \underline{3} \textbf{bonbons}\\
		
	\end{tabular}
	\caption{Quelques relations de dépendances universelles de Stanford \cite{2014-de-marneffe-al} (\url{https://universaldependencies.org/u/dep/index.html})}
\end{table}

\end{frame}

%===================================================================================
\section{Analyse des constituants}
%===================================================================================

\begin{frame}
\frametitle{Analyse syntaxique}
\framesubtitle{Analyse des constituants}

%\begin{itemize}
%	\item Méthodes classiques 
%	\begin{itemize}
%		\item CKY
%		\item LR 
%	\end{itemize}
%	\item Apprentissage automatique 
%	\begin{itemize}
%		\item CKY probabiliste
%	\end{itemize}
%\end{itemize}

\begin{tabular}{|p{.3\textwidth}|p{.3\textwidth}|p{.3\textwidth}|}
	\hline
	& Méthodes classiques & Apprentissage automatique \\
	\hline
	Analyse ascendante & CKY & CKY probabiliste\\
	\hline
	Analyse descendante &  & \\
	\hline
\end{tabular}

\end{frame}

\subsection{Algorithme CKY}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des constituants}
\framesubtitle{Algorithme CKY}

\begin{itemize}
	\item Algorithme de Cocke-Kasami-Younger
	\item Analyse ascendante
	\item Prérequis : Forme normale de Chomsky
\end{itemize}

\begin{definition}[FNC : Forme normale de Chomsky]
	\[
	A \rightarrow  B C \text{ où } A, B, C \in N
	\]
	
	\[
	A \rightarrow w \text{ où } w \in \Sigma
	\]
\end{definition}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des constituants}
\framesubtitle{Algorithme CKY : Reconnaissance d'une phrase}

\vspace{-6pt}
\begin{block}{CKY : Reconnaissance d'une phrase}
	\scriptsize\vspace{-3pt}
	\begin{algorithm}[H]
		\Donnees{une grammaire $G <\Sigma, N, P, S>$ en FNC; une phrase $w = w_1 \ldots w_n$}
		\Res{$T[n, n], B[n, n, |N|]$}
		
		\Pour{$ i = 1 \ldots n$}{ 
			$T[i-1, j] \leftarrow \{  A / (A \rightarrow w_j) \in P \} $\;
		}
		
		\Pour{$ j = 2 \ldots n$ }{%\tcc*{Iitialiser le diagonal}
			\Pour{$ i = 0 \ldots (n - j) $}{
				\Pour{$ k = (i+1) \ldots (i + j -1 ) $}{
					\PourTous{$A$ tel que $(A \rightarrow B C) \in P $ et $B \in T[i, k]$ et $C \in T[k, i+j]$}{ 
						$T[i, i+j] \leftarrow T[i, i+j] \cup \{A\}$ ;
						$B[i, i+j, A] \leftarrow B[i, i+j, A] \cup \{(B, C, k)\}$ \;
					}
				}
			}
		}
	
		\Si{$``S" \notin T[0, n] $} {
			Erreur ``La phrase n'a pas été reconnue"\;
		}
	
		\Retour $T, B$ \;
		\vspace{-3pt}
	\end{algorithm}
\end{block}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des constituants}
\framesubtitle{Algorithme CKY : Construction de l'arbre}

\vspace{-6pt}
\begin{block}{CKY : Construction de l'arbre}
	\scriptsize\vspace{-3pt}
	\begin{algorithm}[H]
		\SetKwFunction{FConst}{Construire}
		\SetKwProg{Fn}{Fonction}{\\Début}{Fin}
		
		\Donnees{$T[n, n], B[n, n, |N|]$}
		\Res{Arbre syntaxique}
		
		\eSi{$``S" \notin T[0, n] $} {
			\Retour $\varnothing$ \;
		}{
			\Retour \FConst{$S, 0, n$}\;
		}
		
		\Fn{\FConst{$A, i, j$}}{
		
			\eSi{j = i + 1}{
				\Retour $A$\;
			}{
				$ (B, C, k) \leftarrow Choisir(B[i, j, A]) $\;
				\Retour (\FConst{$B, i, k$}, \FConst{$C, k, j$})\;
			}
		}
		
		
%		\vspace{-3pt}
	\end{algorithm}
\end{block}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des constituants}
\framesubtitle{Algorithme CKY : Exercice}

\vspace{-6pt}
\begin{exampleblock}{Exemple d'une grammaire}
	\begin{itemize}
		\item S \textrightarrow\ NP VP 
		\item S \textrightarrow\ VP 
		\item VP \textrightarrow V NP
		\item NP \textrightarrow\ DET ADJ N \textbar\ DET N \textbar\ PRON 
		\item PRON \textrightarrow\ je \textbar\ tu \textbar\ il \textbar\ elle
		\item V \textrightarrow\ forme \textbar\ veut \textbar\ mange 
		\item DET \textrightarrow\ un \textbar\ une \textbar\ la \textbar\ le
		\item ADJ \textrightarrow\ petite \textbar\ grand \textbar\ bleu 
		\item N \textrightarrow\ petite \textbar\ forme \textbar\ phrase \textbar\ chat \textbar\ poisson
	\end{itemize}
\end{exampleblock}\vspace{-6pt}

\begin{itemize}
	\item Analyser la phrase suivante en utilisant CKY 
	\item \expword{la petite forme une petite phrase}
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des constituants}
\framesubtitle{Algorithme CKY : Remarques}

\begin{itemize}
	\item L'arbre syntaxique résultante est binaire. Mais, dans la réalité elle doit suivre la grammaire conçue par les syntacticiens
	\begin{itemize}
		\item Ajouter une étape de post-traitement pour récupérer l'arbre originale
		\item Laisser les productions unitaires et modifier l'algorithme CKY afin de les accepter
	\end{itemize}
	\item Problème d'ambigüité syntaxique 
	\begin{itemize}
		\item Ex. \expword{Je mange du riz avec une fourchette.} et \expword{Je mange du riz avec de la viande.}
%		\item 
	\end{itemize}
\end{itemize}

\end{frame}

\subsection{Algorithme CKY probabiliste}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des constituants}
\framesubtitle{Algorithme CKY probabiliste}

\begin{itemize}
	\item $G<\Sigma, N, P, S>$ est une grammaire probabiliste
	\item Les nouvelles règles créées par transformation en FNC ont une probabilité égale à $1$
	\item $w = w_1 \ldots w_n$ est un mot à analyser 
	\item $T$ est un arbre syntaxique 
	\item $P(T, w) = \prod\limits_{(A_i \rightarrow \beta_i) \in T} P(A_i \rightarrow \beta_i)$ est la probabilité d'une arbre syntaxique étant donné le mot analysé
	\item $\hat{T}(w) = \arg\max\limits_{T(w)} P(T, w) $ est l'arbre syntaxique la plus adéquate pour analyser le mot $w$
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des constituants}
\framesubtitle{Algorithme CKY probabiliste : Reconnaissance d'une phrase}

\vspace{-6pt}
\begin{block}{CKY probabiliste : Reconnaissance d'une phrase}
	\scriptsize\vspace{-3pt}
	\begin{algorithm}[H]
		\Donnees{une grammaire probabiliste $G <\Sigma, N, P, S>$ en FNC; une phrase $w = w_1 \ldots w_n$}
		\Res{$T[n, n, |N|], B[n, n, |N|]$}
		
		\Pour{$ i = 1 \ldots n$}{ 
			\PourTous{$A / (A \rightarrow w_j) \in P$}{
				$T[i-1, j, A] \leftarrow P(A \rightarrow w_j)$\;
			}
		}
		
		\Pour{$ j = 2 \ldots n$ }{%\tcc*{Iitialiser le diagonal}
			\Pour{$ i = 0 \ldots (n - j) $}{
				\Pour{$ k = (i+1) \ldots (i + j -1 ) $}{
%					\PourTous{$A$ tel que $(A \rightarrow B C) \in P $ et $B \in T[i, k]$ et $C \in T[k, i+j]$}{ 
						$T[i, i+j, A] \leftarrow \max\limits_{A \rightarrow B C \in P} P(A \rightarrow B C) * T[i, k, B] * T[k, i+j, C]$ \;
						$B[i, i+j, A] \leftarrow (B, C, k)$\;
%					}
				}
			}
		}
		
		\texttt{// Si $``S" \notin T[0, n] $ : Erreur}
%		\Si{} {
%			Erreur ``La phrase n'a pas été reconnue"\;
%		}
		
		\Retour $T, B$ \;
		\vspace{-3pt}
	\end{algorithm}
\end{block}

\end{frame}


%===================================================================================
\section{Analyse des dépendances}
%===================================================================================

\begin{frame}
\frametitle{Analyse syntaxique}
\framesubtitle{Analyse des dépendances}

\begin{itemize}
	\item 
\end{itemize}

\end{frame}

\subsection{shift-reduce}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des dépendances}
\framesubtitle{shift-reduce}

\begin{itemize}
	\item 
\end{itemize}

\end{frame}

\subsection{Arc-Eager}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des dépendances}
\framesubtitle{Arc-Eager}

\begin{itemize}
	\item 
\end{itemize}

\end{frame}

\subsection{Arbre couvrant de poids minimal}

\begin{frame}
\frametitle{Analyse syntaxique : Analyse des dépendances}
\framesubtitle{Arbre couvrant de poids minimal}

\begin{itemize}
	\item 
\end{itemize}

\end{frame}

\insertbibliography{TALN05}{*}

\end{document}

